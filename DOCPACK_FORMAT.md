# What the HELL is .docpack???

A .docpack file is your artifact of truth:
the complete, portable, self-contained representation of everything Doctown extracted,
analyzed, embedded, and generated from a repository.

Think of it as a single zip containing a knowledge-graph + embeddings + generated documentation + metadata.

## Structure

It's a renamed .zip folder with this structure:

```
myproject.docpack
|
├── manifest.json
├── filestructure.json
├── chunks.json
├── embeddings.bin
├── graph.json
├── documentation.json
└── README.md
```

### manifest.json
A metadata header. Human-readable, stable, and universal.

```json
{
  "docpack_version": "6.0.0",
  "source_repo": "https://github.com/user/repo",
  "branch": "main",
  "generated_at": "2025-11-25T17:00:00Z",
  "total_files": 123,
  "total_chunks": 804,
  "embedding_dimensions": 1024,
  "generator": {
    "builder_version": "v6",
    "embedder": "sentence-transformers/jina",
    "gpu_used": true
  }
}
```

### filestructure.json
This is exactly what your current ingest is producing.
It’s the hierarchical file tree. Directories, files, sizes, but not contents.

### chunks.json
A flat list of all extracted text chunks with stable IDs.

```json
[
  {
    "chunk_id": "chunk_001823",
    "file_path": "src/main.rs",
    "start": 0,
    "end": 240,
    "text": "..."
  },
  {
    "chunk_id": "chunk_001824",
    "file_path": "src/main.rs",
    "start": 241,
    "end": 480,
    "text": "..."
  }
]
```

This keeps the embeddings and content decoupled, which is critical for future upgrades.

### embeddings.bin
A big binary file, no JSON bloat.
All embeddings serialized as contiguous `float32` arrays.

Format:
- row-major
- `N` rows (equal to number of chunks)
- `D` columns (embedding dims)

Size: `N * D * 4 bytes`

Index mapping:
- `embeddings[row_of_chunk_i] == chunk_i.embedding`

The row order should match `chunks.json`.

### graph.json
A semantic graph of the project.
Nodes, edges, relationships, centrality scores.

Simple pseudo:

```json
{
  "nodes": [
    {
      "id": "file:src/main.rs",
      "type": "file",
      "name": "main.rs",
      "chunks": ["chunk_001823", "chunk_001824"],
      "pagerank": 0.0843
    }
  ],
  "edges": [
    {
      "from": "file:src/main.rs",
      "to": "file:src/lib.rs",
      "type": "semantic_similarity",
      "score": 0.9123
    }
  ]
}
```

This is where embeddings become structure. The core of Doctown’s “map.”

### documentation.json
This is your generated docs (rule-based to bypass LLM for early testing):

```json
{
  "summaries": [
    {
      "symbol_id": "file:src/main.rs",
      "summary": "...",
      "details": "...",
      "related": ["file:src/lib.rs"]
    }
  ],
  "architecture_overview": "...",
  "highlights": [...]
}
```

This is where the “magic” happens from the user’s POV.

### README.md
Human-readable entrypoint for the docpack:

```markdown
# Project Documentation (Generated by Doctown v6)

- Source: https://github.com/user/repo
- Generated: DD-MM-YYYY
- Files: 123
- Chunks: 804
- Embedding dims: 1024

For programmatic use, see manifest.json.
```